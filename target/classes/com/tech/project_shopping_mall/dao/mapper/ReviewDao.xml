<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.tech.project_shopping_mall.dao.ReviewDao">

	<select id="selectReviewTotCount" resultType="Integer">
		SELECT COUNT(*) FROM REVIEW
	</select>
	
	<insert id="review_write">
		INSERT INTO REVIEW VALUES(REVIEW_SEQ.NEXTVAL,
		0,#{param1},#{param2},#{param3},#{param4},
		0,0,SYSDATE,0)
	</insert>

	<select id="review_view" resultType="com.tech.project_shopping_mall.dto.ReviewDto">
		SELECT R_NUM,P_CODE,R_STARPOINT,R_TITLE,R_CONTENTS
			,R_IMG,R_LIKEPOINT,MID,R_DATE,R_HIT
			FROM REVIEW WHERE R_NUM=#{param1}
	</select>

	<select id="review_list" resultType="com.tech.project_shopping_mall.dto.ReviewDto">
		SELECT R_NUM,P_CODE,R_STARPOINT,R_TITLE,R_CONTENTS
		,R_IMG,R_LIKEPOINT,MID,R_DATE,R_HIT
		FROM (SELECT ROWNUM NUM,N.* FROM (SELECT * FROM REVIEW ORDER BY R_DATE DESC) N)
	</select>

 	<update id="review_modify">
		UPDATE REVIEW
			SET MID=#{param2}, R_TITLE=#{param3},
			R_CONTENTS=#{param4}	WHERE R_NUM=#{param1}
	</update>
	
	<update id="review_upHit">
		UPDATE REVIEW
			SET R_HIT=R_HIT+1
			WHERE R_NUM=#{param1}
	</update>
	<delete id="review_delete">
		DELETE FROM REVIEW WHERE R_NUM=#{param1}
	</delete>
	 
</mapper>